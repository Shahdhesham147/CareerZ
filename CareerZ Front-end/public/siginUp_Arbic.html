<!DOCTYPE html>
<html lang="ar">
<head>

           <!-- Font -->
    <link href="https://fonts.googleapis.com/css2?family=League+Spartan:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Css links -->
       <link rel="stylesheet" href="../src/css/all.min.css">
    <link rel="stylesheet" href="../src/css/signUp_Arabic.css">
    <link rel="stylesheet" href="../src/css/bootstrap.min.css">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تسجيل حساب</title>
</head>
<body>

  
  <nav class="navbar back-default navbar-expand-md fixed-top pb-0" id="navbar">
    <div class="container-fluid mx-5">
      
      <a class="navbar-brand" href="#">
        <img src="../src/img/New logo 1.png" alt="" class="logo">
      </a>
    
      <button class="navbar-toggler " type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
        <i class="fa-solid fa-bars fa-lg d-flex justify-content-center align-items-center my-3"></i>
      </button>
      
      <div class="collapse navbar-collapse justify-content-end" id="navbarNavDropdown">
        <ul class="navbar-nav">
           <li class="nav-item p-3"><a class="nav-link active" href="index_Arabic.html">الرئيسية</a></li>
          <li class="nav-item p-3"><a class="nav-link" href="arabiccourses.html">الكورسات</a></li>
          <li class="nav-item p-3"><a class="nav-link" href="internship_Arabic.html">التدريب</a></li>
          <li class="nav-item p-3"><a class="nav-link" href="#">معلومات عنا</a></li>
          <li class="nav-item p-3"><a class="nav-link" href="#">تواصل</a></li>
        </ul>
        </ul>
        
        <form class="d-flex">
           <div class="dropdown">
  <i class="fa-solid fa-circle-user icon m-3 mx-5 dropdown-toggle" 
     id="userMenu" 
     data-bs-toggle="dropdown"               
     aria-expanded="false"
     style="font-size: 30px; cursor: pointer;"></i>

  <ul class="dropdown-menu" aria-labelledby="userMenu">
    <li><a class="dropdown-item" href="profile_Arabic.html"> حساب شخصي </a></li>
    <li><a class="dropdown-item" href="All signUP_Arabic.html"> انشاء حساب </a></li>
    <li><a class="dropdown-item" href="All login_Arabic.html">تسجيل دخول</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="#">تسجيل خروج</a></li>
  </ul>
</div>
          <button class="" id="Btn">EN</button>
        </form>
        
      </div>
    </div>    

  </nav>

    <div class=" sign row row-cols-1 row-cols-md-3 w-100" >
        <div class=" col p-5 SignUP">
            <h1 class="sign-word">انشاء حساب جديد</h1>
            <form id="signupForm" >
                <div class="mb-3">
                    <label for="exampleInputname" class="form-label">اسم المستخدم</label>
                    <input type="text" class="form-control rounded-4" id="exampleInputname" aria-describedby="nameHelp">
                </div>
                <div class="mb-3">
                    <label for="exampleInputEmail1" class="form-label">البريد الإلكتروني</label>
                    <input type="email" class="form-control rounded-4" id="exampleInputEmail1" aria-describedby="emailHelp">
                </div>
                 <div class="mb-3">
                    <label for="exampleInputphone" class="form-label">رقم الهاتف</label>
                    <input type="text" class="form-control rounded-4" id="exampleInputphone">
                </div>
                <div class="mb-3">
                    <label for="exampleInputPassword1" class="form-label">كلمة المرور</label>
                    <input type="password" class="form-control rounded-4" id="exampleInputPassword1">
                </div>
                <div class="mb-3">
                    <label for="exampleInputPassword2" class="form-label">تأكيد كلمة المرور</label>
                    <input type="password" class="form-control rounded-4" id="exampleInputPassword2">
                </div>
                
                <div class="mb-3">
                    <label for="exampleInputDate" class="form-label d-block">تاريخ الميلاد</label>
                    <input type="date" class="rounded-4 px-3 py-1" id="exampleInputDate">
                </div>
                <label for="exampleInputGender" class="form-label">الجنس</label>
                
                <div class="gender d-flex ">
                    
                    <div class="form-check m-2">
                        <input class="form-check-input" type="radio" name="radioDefault" id="radioDefault1">
                        <label class="form-check-label" for="radioDefault1">
                            ذكر
                        </label>
                    </div>
                    
                    <div class="form-check m-2 ">
                        <input class="form-check-input" type="radio" name="radioDefault" id="radioDefault2">
                        <label class="form-check-label" for="radioDefault2">
                            أنثى
                        </label>
                    </div>
                </div>
                
                <div class="btn-submit text-center p-3"></a>
                 <a href="quiz intro_ِArabic.html">   <button type="button" class="btn mt-4 btn_sginUP">إرسال</button>
                </div>
               <a href="login_Arabic.html"> <p class="pt-1 already text-center">هل لديك حساب بالفعل؟ <a href="../public/login_Arabic.html" class="convertLogin">تسجيل دخول</a></p></a>
            </form>
        </div>
        

        <div class="middle-pic">
            <img src="../src/img/middle-pic.png" alt="" class="bg">
        </div>


        <div class="blueback col my-5">

        </div>
    </div>

<script>
  const btn = document.getElementById("Btn");

  btn.textContent = "EN"; 

  btn.addEventListener("click", function (e) {
    e.preventDefault();
    if (btn.textContent.trim() === "EN") {
      btn.textContent = "Arabic"; 
      window.location.href = "signUp.html"; 
    } else {
      btn.textContent = "EN";
      window.location.href = "siginUp_Arbic.html"; 
    }
  });

// API 
  const signupForm = document.getElementById("signupForm");

  signupForm.addEventListener("submit", async (e) => {
    e.preventDefault(); // منع الفورم من الارسال مباشرة

    // الحصول على القيم
    const user_name = document.getElementById("exampleInputname").value.trim();
    const email = document.getElementById("exampleInputEmail1").value.trim();
    const phone_number = document.getElementById("exampleInputphone").value.trim();
    const password = document.getElementById("exampleInputPassword1").value;
    const confirmPassword = document.getElementById("exampleInputPassword2").value;
    const gender = document.querySelector('input[name="radioDefault"]:checked')?.value;
    const birthdate = document.getElementById("exampleInputDate").value;

    // التحقق من الحقول الفاضية
    if(!user_name || !email || !phone_number || !password || !confirmPassword || !gender || !birthdate){
        alert("Missing fields");
        return;
    }

    // التحقق من صيغة الإيميل
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if(!emailRegex.test(email)){
        alert("Invalid email format");
        return;
    }

    // التحقق من رقم الهاتف
    const phoneRegex = /^\d{11,}$/; // 11 رقم على الأقل
    if(!phoneRegex.test(phone_number)){
        alert("Phone number must be at least 11 digits");
        return;
    }

    // التحقق من الباسورد
    const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{6,}$/;
    if(!passwordRegex.test(password)){
        alert("Password must be at least 6 characters, contain 1 uppercase, 1 lowercase, and 1 number");
        return;
    }

    // التحقق من تطابق الباسورد
    if(password !== confirmPassword){
        alert("Passwords do not match");
        return;
    }

    // لو كل شيء صح
    try {
      const res = await fetch("http://localhost:8888/signup", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          user_name,
          email,
          password,
          confirmPassword,
          phone_number,
          birthdate,
          gender
        })
      });

      const data = await res.json()

      if (res.ok) {
        alert("✅ Signup successful!");
        console.log("User registered:", data);
        window.location.href = "login.html";
      } else {
        alert("❌ Error: " + data.error)
      }
    } catch (error) {
      console.error("Request failed:", error);
      alert("❌ " + error.message); 
    }
});
</script>


<script src="../src/js/bootstrap.bundle.min.js"></script>
    
</body>

</html>
